  <!DOCTYPE html>
  <html lang="ar" dir="rtl">
  <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Ù„ØºØ² Ø±ÙŠØ§Ø¶ÙŠ</title>
      <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
      <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
      <style>
          :root {
              --primary-color: #2c3e50;
              --secondary-color: #3498db;
              --accent-color: #e74c3c;
              --success-color: #27ae60;
              --error-color: #c0392b;
          }

          * {
              margin: 0;
              padding: 0;
              box-sizing: border-box;
          }

          body {
              font-family: 'Cairo', sans-serif;
              background: linear-gradient(135deg, #a8e6cf 0%, #dcedc1 100%);
              min-height: 100vh;
              display: flex;
              justify-content: center;
              align-items: center;
              padding: 20px;
              line-height: 1.6;
              color: var(--primary-color);
          }

          .container {
              max-width: 600px;
              width: 100%;
              background: rgba(255, 255, 255, 0.95);
              padding: 2rem;
              border-radius: 20px;
              box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
              backdrop-filter: blur(10px);
          }

          h1 {
              color: var(--primary-color);
              font-size: 2.5rem;
              margin-bottom: 1.5rem;
              text-align: center;
              position: relative;
              padding-bottom: 15px;
          }

          h1::after {
              content: '';
              position: absolute;
              bottom: 0;
              left: 50%;
              transform: translateX(-50%);
              width: 100px;
              height: 4px;
              background: linear-gradient(to right, var(--secondary-color), var(--accent-color));
              border-radius: 2px;
          }

          .puzzle-section {
              background: #fff;
              padding: 1.5rem;
              border-radius: 15px;
              margin: 1.5rem 0;
              box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
          }

          .puzzle-list {
              list-style: none;
              padding: 0;
              margin: 1.5rem 0;
          }

          .puzzle-list li {
              padding: 15px;
              margin: 10px 0;
              background: #f8f9fa;
              border-radius: 8px;
              font-size: 1.2rem;
              text-align: center;
              transition: transform 0.3s ease;
          }

          .puzzle-list li:hover {
              transform: scale(1.02);
          }

          .puzzle-list li.highlight {
              background: linear-gradient(45deg, #fff6e5, #ffe8cc);
              border: 2px dashed var(--accent-color);
              font-weight: bold;
              font-size: 1.4rem;
              color: var(--accent-color);
              padding: 20px;
          }

          input[type="text"] {
              width: 100%;
              padding: 12px 15px;
              margin: 10px 0;
              border: 2px solid #e0e0e0;
              border-radius: 8px;
              font-size: 1.1rem;
              font-family: 'Cairo', sans-serif;
              transition: all 0.3s ease;
          }

          input[type="text"]:focus {
              border-color: var(--secondary-color);
              box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
              outline: none;
          }

          button {
              width: 100%;
              padding: 12px 25px;
              background: linear-gradient(45deg, var(--secondary-color), #2980b9);
              color: white;
              border: none;
              border-radius: 8px;
              font-size: 1.2rem;
              cursor: pointer;
              font-family: 'Cairo', sans-serif;
              font-weight: 600;
              margin-top: 1rem;
              transition: all 0.3s ease;
          }

          button:hover {
              background: linear-gradient(45deg, #2980b9, var(--secondary-color));
              transform: translateY(-2px);
              box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3);
          }

          button:disabled {
              background: #cccccc;
              cursor: not-allowed;
              transform: none;
              box-shadow: none;
          }

          .form-group {
              margin-bottom: 1.5rem;
          }

          label {
              display: block;
              margin-bottom: 8px;
              font-weight: 600;
              color: var(--primary-color);
              font-size: 1.1rem;
          }

          #result {
              margin-top: 1.5rem;
              padding: 15px;
              border-radius: 8px;
              text-align: center;
              font-size: 1.2rem;
              font-weight: 600;
              display: none;
          }

          #result.success {
              background-color: rgba(39, 174, 96, 0.1);
              color: var(--success-color);
              border: 2px solid var(--success-color);
          }

          #result.error {
              background-color: rgba(192, 57, 43, 0.1);
              color: var(--error-color);
              border: 2px solid var(--error-color);
          }

          .loading {
              display: none;
              text-align: center;
              margin: 20px 0;
          }

          .loading .spinner {
              width: 40px;
              height: 40px;
              margin: 0 auto;
              border: 4px solid #f3f3f3;
              border-top: 4px solid var(--secondary-color);
              border-radius: 50%;
              animation: spin 1s linear infinite;
          }

          @keyframes spin {
              0% { transform: rotate(0deg); }
              100% { transform: rotate(360deg); }
          }

          .blocked-message {
              background-color: #fff3cd;
              color: #856404;
              border: 1px solid #ffeeba;
              padding: 20px;
              border-radius: 8px;
              text-align: center;
              margin: 20px 0;
              font-size: 1.1rem;
          }

          .timer-message {
              background-color: #cce5ff;
              color: #004085;
              border: 1px solid #b8daff;
              padding: 15px;
              border-radius: 8px;
              text-align: center;
              margin: 10px 0;
              font-size: 1rem;
          }
      </style>
  </head>
  <body>
      <div class="container animate__animated animate__fadeIn">
          <h1>Ù„ØºØ² Ø±ÙŠØ§Ø¶ÙŠ Ù…Ù…ØªØ¹</h1>
          
          <div class="puzzle-section">
              <p style="text-align: center; font-size: 1.2rem; margin-bottom: 1rem;">Ø£ÙƒÙ…Ù„ Ø§Ù„Ù†Ù…Ø· Ø§Ù„ØªØ§Ù„ÙŠ:</p>
              <ul class="puzzle-list">
                  <li class="animate__animated animate__fadeInRight">1 Ã— 2 = 5</li>
                  <li class="animate__animated animate__fadeInRight" style="animation-delay: 0.1s">2 Ã— 2 = 20</li>
                  <li class="animate__animated animate__fadeInRight" style="animation-delay: 0.2s">2 Ã— 3 = 43</li>
                  <li class="animate__animated animate__fadeInRight" style="animation-delay: 0.3s">3 Ã— 3 = 90</li>
                  <li class="highlight animate__animated animate__fadeInRight" style="animation-delay: 0.4s">4 Ã— 3 = â“</li>
              </ul>
          </div>

          <div id="formSection" class="puzzle-section">
              <form id="puzzleForm">
                  <div class="form-group">
                      <label for="name">Ø§Ù„Ø§Ø³Ù…</label>
                      <input type="text" id="name" required placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„">
                  </div>

                  <div class="form-group">
                      <label for="answer">Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©</label>
                      <input type="text" id="answer" required placeholder="Ø£Ø¯Ø®Ù„ Ø¥Ø¬Ø§Ø¨ØªÙƒ">
                  </div>

                  <button type="submit" id="submitBtn">ØªØ­Ù‚Ù‚ Ù…Ù† Ø¥Ø¬Ø§Ø¨ØªÙƒ</button>
              </form>

              <div id="result"></div>
              <div class="loading" id="loading">
                  <div class="spinner"></div>
                  <p>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¥Ø¬Ø§Ø¨ØªÙƒ...</p>
              </div>
          </div>
      </div>

      <script>
          (function() {
              emailjs.init("Non4_CdtCimLox-Ow");

              const BLOCK_DURATION = 24 * 60 * 60 * 1000; // 24 Ø³Ø§Ø¹Ø©
              let userIP = null;

              async function getUserIP() {
                  try {
                      const response = await fetch('https://api.ipify.org?format=json');
                      const data = await response.json();
                      return data.ip;
                  } catch (error) {
                      console.error('Error fetching IP:', error);
                      return null;
                  }
              }

              function showResult(message, type) {
                  const resultDiv = document.getElementById('result');
                  const loadingDiv = document.getElementById('loading');
                  
                  loadingDiv.style.display = 'none';
                  resultDiv.textContent = message;
                  resultDiv.className = type;
                  resultDiv.style.display = 'block';
              }

              async function sendEmail(name, answer, isCorrect) {
                  try {
                      const templateParams = {
                          to_email: "motaz-2010@hotmail.com",
                          from_name: name,
                          message: `
                              Ø§Ø³Ù… Ø§Ù„Ù…Ø´Ø§Ø±Ùƒ: ${name}
                              Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©: ${answer}
                              Ø§Ù„Ù†ØªÙŠØ¬Ø©: ${isCorrect ? 'ØµØ­ÙŠØ­Ø©' : 'Ø®Ø§Ø·Ø¦Ø©'}
                              Ø¹Ù†ÙˆØ§Ù† IP: ${userIP}
                              Ø§Ù„ØªØ§Ø±ÙŠØ®: ${new Date().toLocaleString('ar-SA')}
                          `
                      };

                      const response = await emailjs.send(
                          "service_za7kjb6",
                          "template_90rsv3y",
                          templateParams
                      );

                      return true;
                  } catch (error) {
                      console.error("Ø®Ø·Ø£ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯:", error);
                      return false;
                  }
              }

              function checkPreviousAttempt() {
                  if (!userIP) return false;

                  const storedData = localStorage.getItem(`puzzle_attempt_${userIP}`);
                  if (!storedData) return false;

                  const { timestamp } = JSON.parse(storedData);
                  const now = new Date().getTime();
                  const timeDiff = now - timestamp;

                  if (timeDiff < BLOCK_DURATION) {
                      const remainingHours = Math.floor((BLOCK_DURATION - timeDiff) / (1000 * 60 * 60));
                      const remainingMinutes = Math.floor(((BLOCK_DURATION - timeDiff) % (1000 * 60 * 60)) / (1000 * 60));

                      const formSection = document.getElementById('formSection');
                      formSection.innerHTML = `
                          <div class="blocked-message">
                              <h2>Ø¹Ø°Ø±Ø§Ù‹!</h2>
                              <p>Ù„Ù‚Ø¯ Ù‚Ù…Øª Ø¨Ø­Ù„ Ø§Ù„Ù„ØºØ² Ù…Ø³Ø¨Ù‚Ø§Ù‹</p>
                              <div class="timer-message">
                                  ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ø¨Ø¹Ø¯ ${remainingHours} Ø³Ø§Ø¹Ø© Ùˆ ${remainingMinutes} Ø¯Ù‚ÙŠÙ‚Ø©
                              </div>
                          </div>
                      `;
                      return true;
                  }

                  localStorage.removeItem(`puzzle_attempt_${userIP}`);
                  return false;
              }

              document.getElementById('puzzleForm').addEventListener('submit', async function(event) {
                  event.preventDefault();

                  const submitBtn = document.getElementById('submitBtn');
                  const loadingDiv = document.getElementById('loading');
                  const name = document.getElementById('name').value.trim();
                  const answer = document.getElementById('answer').value.trim();

                  if (!name || !answer) {
                      showResult('ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©', 'error');
                      return;
                  }

                  submitBtn.disabled = true;
                  loadingDiv.style.display = 'block';

                  const correctAnswer = "153";
                  const isCorrect = answer === correctAnswer;

                  if (userIP) {
                      localStorage.setItem(`puzzle_attempt_${userIP}`, JSON.stringify({
                          timestamp: new Date().getTime(),
                          name: name,
                          answer: answer,
                          isCorrect: isCorrect
                      }));
                  }

                  const emailSent = await sendEmail(name, answer, isCorrect);

                  if (isCorrect) {
                      showResult('ğŸ‰ Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©! Ø£Ø­Ø³Ù†Øª ÙŠØ§ ' + name, 'success');
                  } else {
                      showResult('Ù„Ù„Ø£Ø³Ù Ø¥Ø¬Ø§Ø¨Ø© ØºÙŠØ± ØµØ­ÙŠØ­Ø©. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ø¨Ø¹Ø¯ 24 Ø³Ø§Ø¹Ø©!', 'error');
                  }

                  setTimeout(() => {
                      const formSection = document.getElementById('formSection');
                      formSection.innerHTML = `
                          <div class="puzzle-section">
                              <h2 style="text-align: center; color: var(--primary-color);">Ø´ÙƒØ±Ø§Ù‹ Ù„Ù…Ø´Ø§Ø±ÙƒØªÙƒ!</h2>
                              <p style="text-align: center; margin-top: 15px;">
                                  ${isCorrect ? 
                                      'ØªÙ‡Ø§Ù†ÙŠÙ†Ø§! Ù„Ù‚Ø¯ Ø­Ù„Ù„Øª Ø§Ù„Ù„ØºØ² Ø¨Ù†Ø¬Ø§Ø­. ğŸ‰' : 
                                      'Ø´ÙƒØ±Ø§Ù‹ Ù„Ù…Ø­Ø§ÙˆÙ„ØªÙƒ! ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ø¨Ø¹Ø¯ 24 Ø³Ø§Ø¹Ø©.'}
                              </p>
                              <p style="text-align: center; margin-top: 10px; color: ${emailSent ? 'green' : 'red'}">
                                  ${emailSent ? 
                                      'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ù…Ø´Ø§Ø±ÙƒØªÙƒ Ø¨Ù†Ø¬Ø§Ø­' : 
                                      'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ù„Ø§Ø­Ù‚Ø§Ù‹'}
                              </p>
                          </div>
                      `;
                  }, 3000);
              });

              (async function init() {
                  userIP = await getUserIP();
                  checkPreviousAttempt();
              })();
          })();
      </script>
  </body>
  </html>
